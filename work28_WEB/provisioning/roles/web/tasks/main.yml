---

  - name: Add multiple repositories 
    yum_repository:
      name: epel
      description: EPEL YUM repo
      file: external_repos
      baseurl: https://download.fedoraproject.org/pub/epel/$releasever/$basearch/
      gpgcheck: no


  - name: install epel-release
    yum:
     name:
      - epel-release
     state: latest
    tags: install-packages


  - name: Disable SELinux
    selinux:
      state: disabled


  - name: stop and disable firewalld
    systemd:
      name: firewalld
      state: stopped
      enabled: no


  - name: install package
    yum:
     name:
      - net-tools
      - vim
      - zip
      - unzip
      - traceroute
      - mtr
      - mc
      - tcpdump
      
      
  - name: set up docker stable repo
    command: yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
    tags: docker

  - name: install docker
    yum:
     name:
      - docker-ce
    ignore_errors: yes


  - name: Download docker-compose
    raw: curl -L "https://github.com/docker/compose/releases/download/1.26.2/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
    args:
        chdir: /tmp

  - name: start docker
    systemd:
      name: docker
      state: started
      enabled: yes



  - name: chmod +x /usr/local/bin/docker-compose
    file:
      path: /usr/local/bin/docker-compose
      owner: root
      group: root
      mode: '0755'


  - name: Create a symbolic link docker
    file:
      src: /usr/local/bin/docker-compose
      dest: /usr/bin/docker-compose
      owner: root
      group: root
      state: link

