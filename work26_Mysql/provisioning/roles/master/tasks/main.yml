---

  - name: "Add Percona yum repository"
    yum:
      name: https://repo.percona.com/yum/percona-release-latest.noarch.rpm
      state: present
 


  

  - name: Add multiple repositories 
    yum_repository:
      name: epel
      description: EPEL YUM repo
      file: external_repos
      baseurl: https://download.fedoraproject.org/pub/epel/$releasever/$basearch/
      gpgcheck: no


  - name: install epel-release
    yum:
     name:
      - epel-release
     state: latest
    tags: install-packages


  - name: Disable SELinux
    selinux:
      state: disabled


  - name: stop and disable firewalld
    systemd:
      name: firewalld
      state: stopped
      enabled: no


  - name: install package
    yum:
     name:
      - net-tools
      - vim
      - zip
      - unzip
      - traceroute
      - mtr
      - mc
      - tcpdump
      - Percona-Server-server-57
      - python3-PyMySQL
      - python3
      - MySQL-python



  - name: Copy conf mysql
    copy:
      src: files/{{ item }}
      dest: /etc/my.cnf.d/{{ item }}
      owner: root
      group: root
      mode: '0775'
    loop:
      - 01-base.cnf
      - 02-max-connections.cnf
      - 03-performance.cnf
      - 04-slow-query.cnf
      - 05-binlog.cnf


  - name: start mysql
    systemd:
      name: mysql
      state: started
      enabled: yes


  - name: Create a new database with name 'bobdata'
    mysql_db:
      name: bet
      state: present